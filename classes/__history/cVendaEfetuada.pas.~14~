unit cVendaEfetuada;

interface

uses
  System.Classes, Vcl.Controls, Vcl.ExtCtrls, Vcl.Dialogs, System.SysUtils,
  datamodule, Data.DB, cCliente;

type
  TcVendaEfetuada = class
  private
    FId: Integer;
    FIdProduto: Integer;
    FQuantidade: Integer;
    FValorTotalCompra: Double;
    FCpfCliente: string;

  public
    property Id: Integer read FId write FId;
    property IdProduto: Integer read FIdProduto write FIdProduto;
    property Quantidade: Integer read FQuantidade write FQuantidade;
    property PrecoTotalCompra: Double read FValorTotalCompra write FValorTotalCompra;
    property cpfCliente: string read FCpfCliente write FCpfCliente;

    procedure Insert(idProduto: integer; quantidade: integer; valorTotalCompra: double; cpfCliente: string);

  end;

implementation

procedure TcVendaEfetuada.Insert
  (idProduto: integer; quantidade: integer; valorTotalCompra: double; cpfCliente: string);
var
  Cliente: TcCliente;
begin
  Cliente := TcCliente.Create;
  try

    if  then
    begin

      with uDataModule.qryVendaEfetuadaInsert do
      begin
        Close;
        Cliente.CheckExistenceByCPF(cpfCliente)
        Parameters.ParamByName('id_produto').Value := idProduto;
        Parameters.ParamByName('quantidade').Value := quantidade;
        Parameters.ParamByName('valor_total_compra').Value := valorTotalCompra;
        Parameters.ParamByName('cpf_cliente').Value := cpfCliente;
        ExecSQL;
      end;

      ShowMessage('Venda registrada com sucesso!');
    end
    else
    begin
      // Cliente não encontrado ? interrompe
      ShowMessage('Nenhum cliente cadastrado com o CPF informado.');
      Exit;
    end;
  finally
    Cliente.Free;
  end;
end;


end.

